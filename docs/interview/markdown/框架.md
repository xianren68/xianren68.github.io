# 框架

## vue

### vue2 和 vue3的区别？

#### 1. 写法

> vue2采用选项式(options) api，vue3采用组合式（composition) api
>
> 相比于选项式api，组合式api更灵活，业务逻辑更加清晰，而且代码重用和维护也更加方便

#### 2. 大小和性能

> vue3相比于vue2，重写了虚拟dom的实现，改进了diff算法，并优化了模板编译，进行了静态节点提升，组件初始化等操作，取得了速度的提升
>
> 而且vue3采用tree-sharking功能，很多模块例如ref,onMounted等都可以进行按需加载，进一步减小了包的体积

#### 3. 类型支持

> vue3使ts构建的，相比于vue2，vue3的类型系统更加完善，对ts的支持也更好

#### 4. 响应式原理

##### vue2

> vue2使用Object.defineProperty来对data中的数据递归进行响应式监听，但这导致后续如果想添加响应式数据就要调用vue api来完成
>
> 而且对于数组元素的变化就只能通过重写数组方法来完成响应式的监听，有些不方便

##### vue3

> vue3使用es6的proxy api来对数据进行响应式的监听，它可以很方便的对数组，对象进行监听，同时将响应式api(ref, reactive)提取出来，不再像以前一样都必须写再data中，而可以根据逻辑定义其所在位置

#### 5. 是否支持多个根节点

> vue2组件中只能有一个根节点，而vue3可以有多个

### vue自定义指令

#### 1. vue自定义指令是什么？

> 自定义指令是vue提供的，允许开发者可以在vue模板中以命令式的方式拓展dom，自定以指定可以钩入vue生命周期，对dom进行一些底层的操作

#### 2. 例子


```vue
// 定义一个自动获取聚焦框的指令
Vue.directive('focus', {
    inserted:(e) => {
        e.focus()
    }
})
```

### v-if 和 v-for的优先级

#### vue2

> 在vue2中，v-for的优先级高于v-if, 同时使用，可能导致性能浪费，因为v-for所有元素都会遍历，然后再每个都通过v-if来判断，这造成不必要的计算

#### vue3

> 在vue3中， v-if的优先级高于v-for，由于v-if先执行，它可能会访问循环中的变量，而循环还未执行，这会导致运行时错误

::: info
vue官方不推荐让两个指令一起用，应尽量避免
:::

